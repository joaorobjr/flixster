---
title: "Movies Recommendation in Flixster"
author: "Robson Teixeira, Nuno Gomes"
date: Sys.Date()
output: html_document
params:
  year: 2020
  region: Europe
  printcode: TRUE
---
***
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#### **Introduction**  

This practical assignment aims to compare the performance of diferent recommendation strategies on a data set obtained from `Flixster`, a social movie site allowing users to share movie ratings, discover new movies and meet others with similar movie taste.  

#### **Problem Definition**  
Obtain recommendations of movies for a set of users.  

#### **Data Preparation**

The `Flixster` dataset contains informations regarding the users like user id, gender, age, location, for how long it has been a member, contains information regarding movies as name and movie id and  contains information on the ratings given by users to movies and on which date. This datas are distributed in following files:

* profile.txt
* movie-names.txt
* Ratings.time.txt

##### **Users Information**

Load user informations from profile.txt file:

```{r loaduser, warning=FALSE, message=FALSE}
library(tidyverse)

#load user informations from profile.txt file and setting the NA strings
df_user <- read.csv("data/profile.txt", na.strings = c("N/A",""), stringsAsFactors = FALSE)

str(df_user)
```

The data set consists of 1002796 observations spread across 7 variables: 

Variables   |Type        |Description
------------|------------|------------------------------
userid      |integer     |User unique identifier
gender      |character   |User gender
location    |integer     |User location identifier
memberfor   |Date        |Date that user became member
lastlogin   |integer     |Identifier the last login
profileview |integer     |Identifier the profile view
age         |integer     |User age

The variables _location_, _memberfor_, _lastlogin_ and _profileview_ are not needed for the context this analysis, so they will be removed.

Getting the metrics about data set:

```{r cleaninguser, warning=FALSE}
#Remove no relevant variables
df_user <- select(df_user, -c(location, memberfor, lastlogin, profileview))

# Setting 'gender' as factors and 'age' as integer
df_user <- df_user %>% mutate(gender = as.factor(gender)) %>% mutate(age = as.integer(age))

summary(df_user)
```

There are a significant number of _NA's_ in variables _gender_ (67529 or around 6.73% of total) and _age_ (255618 or around 25.49% of total). This data will be maintained.

Besides the NA's, the variable _age_ present inconsistent values. The maximum value assigned for this variable is 113 and there are around 2600 users with age over 90 years old.

```{r}
df_user %>% filter(age > 90) %>% count()
```

##### **Movies Information**

Load movies information from movie-name.txt file: 

```{r loadmovies, warning=FALSE, message=FALSE}
#load movies information from movie-name.txt file and setting the NA strings
df_movies <- read.delim("data/movie-names.txt", na.strings = c("N/A",""), stringsAsFactors = FALSE )

str(df_movies)
```

The data set consists of 66730 observations spread across 2 variables:

Variable    |Type        |Description
------------|------------|------------------------------
moviename   |character   |Movie name 
movieid     |integer     |Movie unique identifier

Getting the metrics about data set:

```{r moviessummary}
summary(df_movies)
```

##### **Ratings Information**

Load ratings information from Ratings.timed.txt file:

```{r loadratings}
#load ratings information from Ratings.timed.txt file
df_ratings <- read.table("data/Ratings.timed.txt", header = TRUE, na.strings = c("N/A",""), sep = "\t",
                         skipNul = TRUE, col.names = c("userid", "movieid", "rating", "date"))

str(df_ratings)
```

The data set consists of 8196077 observations spread across 4 variables:

Attribute   |Type        |Description
------------|------------|-------------------------------------------------
userid      |character   |User unique identifier
movieid     |integer     |Movie unique identifier
rating      |numeric     |Rating given by user to movie. Values between 0.5 and 5.0
date        |date        |Data which user rating movie

Each line in file `Ratings.time.txt` represent a user rating to movie.

Getting the metrics about data set:

```{r ratingsumary}
# Setting 'gender' as factors and 'age' as integer
df_ratings <- df_ratings %>% mutate(rating = as.factor(rating)) %>% mutate(date = as.Date(date))

summary(df_ratings)
```

#### **Exploratory Analysis**  





